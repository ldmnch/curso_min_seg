geom_sf(aes(fill = n/Proyecciones_2020), color = NA)+
scale_fill_viridis_c()+
labs(title = "Provincia de Buenos Aires",
subtitle = "Homicidios dolosos en 2020",
fill = "HD/Cant. habitantes")+
theme_minimal()
library(leaflet)
pal <- colorNumeric("viridis", NULL)
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/hab1000),
label = ~paste0(nam, ": ", round(n/hab1000,2)))
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/Proyecciones_2020),
label = ~paste0(nam, ": ", round(n/hab1000,2)))
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/Proyecciones_2020),
label = ~paste0(nam, ": ", round(n/Proyecciones_2020,2)))
library(leaflet)
pal <- colorNumeric("viridis", NULL)
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/Proyecciones_2020),
label = ~paste0(nam, ": ", round(n/Proyecciones_2020,2)))
library(leaflet)
pal <- colorNumeric("viridis", NULL)
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/Proyecciones_2020),
label = ~paste0(nam, ": ", n/Proyecciones_2020))
Base_PUFEAF <- read.csv("~/Escritorio/Cursos/min_seguridad_curso/clase5/data/Base_PUFEAF.csv")
View(Base_PUFEAF)
table(base_PUFEAF$Situacion_De_Servicio)
table(Base_PUFEAF$Situacion_De_Servicio)
table(Base_PUFEAF$Situacion_de_Servicio)
knitr::opts_chunk$set(echo=FALSE)
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE, highlight=TRUE, paged.print=FALSE, prompt=TRUE, strip.white=FALSE)
library(tidyverse)
df <- readxl::read_xlsx("data/Integrado_HD_base_usuaria_2017-2020.xlsx")
ggplot()
tb1 <- df %>% group_by(anio)%>%
summarise(n=n_distinct(Id_hecho))
ggplot(tb1, aes(x=anio, y = n))+
geom_histogram(stat = 'identity')
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
mutate(total_vict = sum(total)) %>%
ggplot(aes(x=anio, y=total_vict))+
geom_line()
df %>% group_by(anio)%>%
summarise(n=n())%>%
mutate(total=sum(n),
perc = (n/total)*100)%>%
ggplot(aes(x=anio, y=perc))+
geom_col()
df %>% group_by(anio, clase_arma)%>%
summarise(n=n())%>%
ggplot(aes(x=anio, y=n, color=clase_arma))+
geom_line()
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))+
geom_col(position = "fill")
df %>%
ggplot(aes(x=cant_inc))+
geom_density()
df %>%
ggplot(aes(x=cant_inc, fill = provincia))+
geom_density()
df %>%
ggplot(aes(x=cant_inc, fill = provincia))+
geom_density(alpha=0.5)
library(viridis)
df %>%
ggplot(aes(x=cant_inc, fill = provincia))+
geom_density(alpha=0.5)+
scale_fill_viridis_d(option="magma")
View(df)
df %>% mutate(region = case_when(
provincia %in% c("CORRIENTES", "ENTRE RIOS", "CHACO", "MISIONES", "FORMOSA") ~ "NEA",
provincia %in% c("CORRIENTES", "ENTRE RIOS", "CHACO", "MISIONES", "FORMOSA")
))
table(df$provincia)
df <- df %>% mutate(region = case_when(
provincia %in% c("CORRIENTES", "CHACO", "MISIONES", "FORMOSA") ~ "NEA",
provincia %in% c("TUCUMÁN", "JUJUY","SALTA", "CATAMARCA", "SANTIAGO DEL ESTERO", "LA RIOJA") ~ "NOA",
provincia %in% c("SAN LUIS", "MENDOZA", "SAN JUAN") ~ "Cuyo",
provincia %in% c("SANTA FE", "CORDOBA", "BUENOS AIRES", "CIUDAD DE BUENOS AIRES", "ENTRE RIOS") ~ "Pampeana",
provincia %in% c("LA PAMPA", "NEUQUEN", "RIO NEGRO", "CHUBUT", "SANTA CRUZ", "TIERRA DEL FUEGO") ~ "Patagonica"
))
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = region))+
geom_col(position = "fill")
df %>% group_by(anio, region)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = region))+
geom_col(position = "fill")
df %>%
ggplot(aes(x=cant_inc, fill = region))+
geom_density()
df %>%
ggplot(aes(x=cant_inc, fill = region))+
geom_density(alpha=0.5)
df %>%
ggplot(aes(x=cant_inc, fill = region))+
geom_density(alpha=0.5)+
scale_fill_viridis_d(option="magma")
df %>%
ggplot(aes(x=cant_inc, fill = region))+
geom_density(alpha=0.5)+
scale_fill_viridis_d()
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density(alpha=0.5)+
scale_fill_viridis_d()
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density(alpha=0.5)
df %>%
ggplot(aes(x=anio))+
geom_density()
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density()
vict_prov_anio <- df %>% group_by(anio, region) %>%
summarise(n = n_distinct(Id_hecho), #Cuento la cantidad de Id_hechos
tot_vic = sum(cant_vic))%>% #Cuento la cantidad de víctimas
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
head(vict_prov_anio)
ggplot(vict_prov_anio, aes(x = anio, y = n, color = region, size = tasa_vic))+
geom_point()+
scale_color_viridis_d(option = "inferno")
ggplot(vict_prov_anio, aes(x = anio, y = n, color = region, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "inferno")
knitr::opts_chunk$set(echo=FALSE)
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE, highlight=TRUE, paged.print=FALSE, prompt=TRUE, strip.white=FALSE)
library(tidyverse)
df <- readxl::read_xlsx("data/Integrado_HD_base_usuaria_2017-2020.xlsx")
df <- df %>% mutate(region = case_when(
provincia %in% c("CORRIENTES", "CHACO", "MISIONES", "FORMOSA") ~ "NEA",
provincia %in% c("TUCUMÁN", "JUJUY","SALTA", "CATAMARCA", "SANTIAGO DEL ESTERO", "LA RIOJA") ~ "NOA",
provincia %in% c("SAN LUIS", "MENDOZA", "SAN JUAN") ~ "Cuyo",
provincia %in% c("SANTA FE", "CORDOBA", "BUENOS AIRES", "CIUDAD DE BUENOS AIRES", "ENTRE RIOS") ~ "Pampeana",
provincia %in% c("LA PAMPA", "NEUQUEN", "RIO NEGRO", "CHUBUT", "SANTA CRUZ", "TIERRA DEL FUEGO") ~ "Patagonica"
))
ggplot()
tb1 <- df %>% group_by(anio)%>%
summarise(n=n_distinct(Id_hecho))
ggplot(tb1, aes(x=anio, y = n))+
geom_histogram(stat = 'identity')
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
mutate(total_vict = sum(total)) %>%
ggplot(aes(x=anio, y=total_vict))+
geom_line()
df %>% group_by(anio)%>%
summarise(n=n())%>%
mutate(total=sum(n),
perc = (n/total)*100)%>%
ggplot(aes(x=anio, y=perc))+
geom_col()
df %>% group_by(anio, clase_arma)%>%
summarise(n=n())%>%
ggplot(aes(x=anio, y=n, color=clase_arma))+
geom_line()
df %>% group_by(anio, region)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = region))+
geom_col(position = "fill")
df %>%
ggplot(aes(x=anio))+
geom_density()
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density()
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density(alpha=0.5)
library(viridis)
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density(alpha=0.5)+
scale_fill_viridis_d()
colores <- c("Femenino" = 'forestgreen', "Masculino" = 'darkorchid2')
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)
vict_prov_anio <- df %>% group_by(anio, region) %>%
summarise(n = n_distinct(Id_hecho), #Cuento la cantidad de Id_hechos
tot_vic = sum(cant_vic))%>% #Cuento la cantidad de víctimas
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
head(vict_prov_anio)
ggplot(vict_prov_anio, aes(x = anio, y = n, color = region, size = tasa_vic))+
geom_point()+
scale_color_viridis_d(option = "inferno")
ggplot(vict_prov_anio, aes(x = anio, y = n, color = region, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "inferno")
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)+
theme_dark()
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)+
theme_minimal()
ggplot(df, aes(x=region))+
geom_bar()
ggplot(df, aes(x=region))+
geom_bar()+
coord_flip()
ggplot(df, aes(x=region))+
geom_bar()+
theme(axis.text.x = element_text(angle = 90))
ggplot(df, aes(x=region))+
geom_bar()+
coord_flip()+
labs(
title = "Homcidios dolosos registrados por región",
subtitle = "2017-2020",
caption = "Fuente: Ministerio de Seguridad de la Nación",
x = "Región",
y = "n"
)
ggplot(df, aes(x=provincia))+
geom_bar()+
coord_flip()+
labs(
title = "Homcidios dolosos registrados por provincia",
subtitle = "2017-2020",
caption = "Fuente: Ministerio de Seguridad de la Nación",
x = "Región",
y = "n"
)
ggplot(df, aes(x=region))+
geom_bar()+
coord_flip()+
labs(
title = "Homcidios dolosos registrados por provincia",
subtitle = "2017-2020",
caption = "Fuente: Ministerio de Seguridad de la Nación",
x = "Región",
y = "n"
)
ggplot(df, aes(x=provincia))+
geom_bar()
ggplot(df, aes(x=provincia))+
geom_bar()+
coord_flip()
ggplot(df, aes(x=provincia))+
geom_bar()+
theme(axis.text.x = element_text(angle = 90))
ggplot(df, aes(x=provincia))+
geom_bar()+
coord_flip()+
labs(
title = "Homcidios dolosos registrados por provincia",
subtitle = "2017-2020",
caption = "Fuente: Ministerio de Seguridad de la Nación",
x = "Provincia",
y = "n"
)
ggplot(df, aes(x=provincia))+
geom_bar()+
coord_flip()+
labs(
title = "Homcidios dolosos registrados por provincia",
subtitle = "2017-2020",
caption = "Fuente: Ministerio de Seguridad de la Nación",
x = "Provincia",
y = "n"
)
casos_prov <- df %>% group_by(provincia)%>%
summarise(n=n_distinct(Id_hecho))
ggplot(casos_prov, aes(x=provincia, y=n))+
geom_col()
ggplot(casos_prov, aes(x=provincia, y=n))+
geom_col()
coord_flip()
ggplot(casos_prov, aes(x=provincia, y=n))+
geom_col()+
ggplot(casos_prov, aes(x=provincia, y=n))+
geom_col()+
coord_flip()
ggplot(casos_prov, aes(x=provincia, y=n))+
geom_col()+
coord_flip()
ggplot(casos_prov, aes(x=provincia, y=n))+
geom_col()+
theme(axis.text.x = element_text(angle = 90))
ggplot(casos_prov, aes(x=provincia, y=n))+
geom_col()+
coord_flip()+
labs(
title = "Homcidios dolosos registrados por provincia",
subtitle = "2017-2020",
caption = "Fuente: Ministerio de Seguridad de la Nación",
x = "Provincia",
y = "n"
)
ggplot(casos_prov, aes(x=reorder(provincia, n), y=n))+
geom_col()+
coord_flip()+
labs(
title = "Homcidios dolosos registrados por provincia",
subtitle = "2017-2020",
caption = "Fuente: Ministerio de Seguridad de la Nación",
x = "Provincia",
y = "n"
)
df %>% group_by(region, clase_arma) %>%
summarise(n=n())
View(df)
df %>% group_by(region, tipo_lugar) %>%
summarise(n=n())
region_lugar <- df %>% group_by(region, tipo_lugar) %>%
summarise(n=n())
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, region, tipo_lugar) %>%
summarise(n=n())
View(region_lugar)
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_bar
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_bar()
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col()
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(fill = 'dodge')
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(position = 'dodge')
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
View(df)
knitr::opts_chunk$set(echo=FALSE)
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE, highlight=TRUE, paged.print=FALSE, prompt=TRUE, strip.white=FALSE)
library(tidyverse)
df <- readxl::read_xlsx("data/Integrado_HD_base_usuaria_2017-2020.xlsx")
df <- df %>% mutate(region = case_when(
provincia %in% c("CORRIENTES", "CHACO", "MISIONES", "FORMOSA") ~ "NEA",
provincia %in% c("TUCUMÁN", "JUJUY","SALTA", "CATAMARCA", "SANTIAGO DEL ESTERO", "LA RIOJA") ~ "NOA",
provincia %in% c("SAN LUIS", "MENDOZA", "SAN JUAN") ~ "Cuyo",
provincia %in% c("SANTA FE", "CORDOBA", "BUENOS AIRES", "CIUDAD DE BUENOS AIRES", "ENTRE RIOS") ~ "Pampeana",
provincia %in% c("LA PAMPA", "NEUQUEN", "RIO NEGRO", "CHUBUT", "SANTA CRUZ", "TIERRA DEL FUEGO") ~ "Patagonica"
))
ggplot()
tb1 <- df %>% group_by(anio)%>%
summarise(n=n_distinct(Id_hecho))
ggplot(tb1, aes(x=anio, y = n))+
geom_histogram(stat = 'identity')
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
mutate(total_vict = sum(total)) %>%
ggplot(aes(x=anio, y=total_vict))+
geom_line()
df %>% group_by(anio)%>%
summarise(n=n())%>%
mutate(total=sum(n),
perc = (n/total)*100)%>%
ggplot(aes(x=anio, y=perc))+
geom_col()
df %>% group_by(anio, clase_arma)%>%
summarise(n=n())%>%
ggplot(aes(x=anio, y=n, color=clase_arma))+
geom_line()
df %>% group_by(anio, region)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = region))+
geom_col(position = "fill")
df %>%
ggplot(aes(x=anio))+
geom_density()
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density()
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density(alpha=0.5)
library(viridis)
df %>%
ggplot(aes(x=anio, fill = region))+
geom_density(alpha=0.5)+
scale_fill_viridis_d()
colores <- c("Femenino" = 'forestgreen', "Masculino" = 'darkorchid2')
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)
vict_prov_anio <- df %>% group_by(anio, region) %>%
summarise(n = n_distinct(Id_hecho), #Cuento la cantidad de Id_hechos
tot_vic = sum(cant_vic))%>% #Cuento la cantidad de víctimas
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
head(vict_prov_anio)
ggplot(vict_prov_anio, aes(x = anio, y = n, color = region, size = tasa_vic))+
geom_point()+
scale_color_viridis_d(option = "inferno")
ggplot(vict_prov_anio, aes(x = anio, y = n, color = region, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "inferno")
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)+
theme_dark()
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)+
theme_minimal()
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, region, clase_arma) %>%
summarise(n=n())
ggplot(region_lugar, aes(x=region, y=n, fill=clase_arma))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
View(region_lugar)
View(df)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, region, tr_edad_inculpado) %>%
summarise(n=n())
ggplot(region_lugar, aes(x=region, y=n, fill=tr_edad_inculpado))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
table(df$sexo_victima)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, sexo_victima, tr_edad_victima) %>%
summarise(n=n())
ggplot(region_lugar, aes(x=sexo_victima, y=n, fill=tr_edad_victima))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, sexo_victima, tr_edad_victima) %>%
filter(sexo_victima != "No corresponde" | tr_edad_victima != "Sin determinar")%>%
summarise(n=n())
ggplot(region_lugar, aes(x=sexo_victima, y=n, fill=tr_edad_victima))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
View(region_lugar)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, sexo_victima, tr_edad_victima) %>%
filter(sexo_victima != "No corresponde" & tr_edad_victima != "Sin determinar")%>%
summarise(n=n())
ggplot(region_lugar, aes(x=sexo_victima, y=n, fill=tr_edad_victima))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, sexo_victima, tr_edad_victima) %>%
filter((sexo_victima != "No corresponde" | sexo_victima != "Sin determinar") & tr_edad_victima != "Sin determinar")%>%
summarise(n=n())
ggplot(region_lugar, aes(x=sexo_victima, y=n, fill=tr_edad_victima))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, sexo_victima, tr_edad_victima) %>%
filter(sexo_victima != "No corresponde" | sexo_victima != "Sin determinar" & tr_edad_victima != "Sin determinar")%>%
summarise(n=n())
ggplot(region_lugar, aes(x=sexo_victima, y=n, fill=tr_edad_victima))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, sexo_victima, tr_edad_victima) %>%
filter(sexo_victima != "No corresponde" & tr_edad_victima != "Sin determinar")%>%
summarise(n=n())
ggplot(region_lugar, aes(x=sexo_victima, y=n, fill=tr_edad_victima))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, region, tipo_lugar) %>%
summarise(n=n())
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, region, tipo_lugar) %>%
summarise(n=n())
```{r}
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(position = 'dodge')+
facet_wrap(.~anio, scales = "free")
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
#Primero hacemos una tabla con la cantidad de homicidios por lugar según región y año
region_lugar <- df %>% group_by(anio, region, tipo_lugar) %>%
summarise(n=n_distinct(Id_hecho))
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(position = 'dodge')
ggplot(region_lugar, aes(x=region, y=n, fill=tipo_lugar))+
geom_col(position = 'dodge')+
facet_wrap(.~anio)
