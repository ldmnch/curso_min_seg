summarise(n=n(),
total_vic = sum(cant_vic))
ggplot(tabla_prov_vic, aes(x=anio, color = provincia, size = cant_vic))+
geom_point()
ggplot(tabla_prov_vic, aes(x=anio, y = n, color = provincia, size = cant_vic))+
geom_point()
tabla_prov_vic <- df %>% group_by(anio, sexo_inculpado, cant_vic) %>%
summarise(n=n(),
total_vic = sum(cant_vic))
ggplot(tabla_prov_vic, aes(x=anio, y = n, color = sexo_inculpado, size = cant_vic))+
geom_point()
View(tabla_prov_vic)
tabla_prov_vic <- df %>% group_by(anio, sexo_inculpado) %>%
summarise(n=n(),
total_vic = sum(cant_vic))
View(tabla_prov_vic)
ggplot(tabla_prov_vic, aes(x=anio, y = n, color = sexo_inculpado, size = cant_vic))+
geom_point()
ggplot(tabla_prov_vic, aes(x=anio, y = n, color = sexo_inculpado, size = total_vic))+
geom_point()
tabla_prov_vic <- df %>% group_by(anio, provincia) %>%
summarise(n=n(),
total_vic = sum(cant_vic))
ggplot(tabla_prov_vic, aes(x=anio, y = n, color = provincia, size = total_vic))+
geom_point()
ggplot(tabla_prov_vic, aes(x=provincia, y = n, color = as.character(anio), size = total_vic))+
geom_point()
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)+
theme_minimal()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, fill = provincia, size = tasa_vic))+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, fill = provincia, size = tasa_vic))+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
scale_fill_viridis_d()+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
scale_fill_viridis_d()+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
scale_color_viridis(discrete = TRUE)+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
scale_color_viridis(discrete = TRUE)+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
scale_color_viridis_d()+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
scale_color_viridis_d(option = "magma")+
geom_point()
df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n) %>%
ggplot(aes(x = anio, y = n, color = provincia, size = tasa_vic))+
scale_color_viridis_d(option = "magma")+
scale_y_log10()+
geom_point()
ggplot(df, aes(x=anio, fill = provincia))+
geom_histogram(position = "fill")
ggplot(df, aes(x=anio, fill = provincia))+
geom_histogram(position = "fill")+
scale_fill_viridis_d(option="magma")
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_histogram(position = "dodge")+
scale_fill_manual(values = colores)
knitr::opts_chunk$set(echo=FALSE)
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE, highlight=TRUE, paged.print=FALSE, prompt=TRUE, strip.white=FALSE)
library(tidyverse)
df <- readxl::read_xlsx("data/Integrado_HD_base_usuaria_2017-2020.xlsx")
ggplot()
ggplot(df, aes(x=anio))+
geom_bar()
df %>% group_by(anio)%>%
summarise(total=sum(cant_vic))%>%
ggplot(aes(x=anio, y=total))+
geom_line()
df %>% group_by(anio)%>%
summarise(n=n())%>%
ungroup()%>%
mutate(total=sum(n),
perc = (n/total)*100)%>%
ggplot(aes(x=anio, y=perc))+
geom_col()
df %>% group_by(anio, clase_arma)%>%
summarise(n=n())%>%
ggplot(aes(x=anio, y=n, color=clase_arma))+
geom_line()
ggplot(df, aes(x=anio, fill = provincia))+
geom_bar(position = "fill")
library(viridis)
ggplot(df, aes(x=anio, fill = provincia))+
geom_bar(position = "fill")+
scale_fill_viridis_d(option="magma")
colores <- c("Femenino" = 'forestgreen', "Masculino" = 'darkorchid2')
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)
vict_prov_anio <- df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
ggplot(aes(vict_prov_anio, x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "magma")
vict_prov_anio
ggplot(aes(vict_prov_anio, x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "magma")
ggplot(vict_prov_anio, aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "magma")
ggplot(vict_prov_anio, aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "magma")
vict_prov_anio <- df %>% group_by(anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
head(vict_prov_anio)
ggplot(vict_prov_anio, aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_color_viridis_d(option = "magma")
ggplot(vict_prov_anio, aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "magma")
ggplot(vict_prov_anio, aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "inferno")
View(vict_prov_anio)
ggplot(vict_prov_anio, aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_color_viridis_d(option = "inferno")
View(df)
df %>% group_by(Id_hecho, anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))
df %>% group_by(Id_hecho, anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
View(df)
df %>% group_by(Id_hecho, anio)%>%
summarise(n=n())
df %>% group_by(anio)%>%
summarise(n=n_distinct(Id_hecho))
ggplot(df, aes(x=anio, y = n))+
geom_bar()
ggplot(df, aes(x=anio, y = n))+
geom_histogram()
tb1 <- df %>% group_by(anio)%>%
summarise(n=n_distinct(Id_hecho))
ggplot(df, aes(x=anio, y = n))+
geom_col()
ggplot(tb1, aes(x=anio, y = n))+
geom_histogram()
ggplot(tb1, aes(x=anio, y = n))+
geom_col()
ggplot(tb1, aes(x=anio, y = n))+
geom_histogram(stat = 'identity')
df %>% group_by(anio)%>%
summarise(total=sum(cant_vic))
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
ungroup()%>%
group_by(anio)%>%
mutate(total_vict = sum(cant_vic))
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
ungroup()%>%
group_by(anio)%>%
mutate(total_vict = sum(total))
View(df)
ggplot(aes(x=anio, y=total_vict))+
geom_line()
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
ungroup()%>%
group_by(anio)%>%
mutate(total_vict = sum(total)) %>%
ggplot(aes(x=anio, y=total_vict))+
geom_line()
View(df)
knitr::opts_chunk$set(echo=FALSE)
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE, highlight=TRUE, paged.print=FALSE, prompt=TRUE, strip.white=FALSE)
library(tidyverse)
df <- readxl::read_xlsx("data/Integrado_HD_base_usuaria_2017-2020.xlsx")
df %>% distinct()
df <- readxl::read_xlsx("data/Integrado_HD_base_usuaria_2017-2020.xlsx")
ggplot()
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
ungroup()%>%
group_by(anio)%>%
mutate(total_vict = sum(total)) %>%
ggplot(aes(x=anio, y=total_vict))+
geom_line()
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
ungroup()%>%
mutate(total_vict = sum(total)) %>%
ggplot(aes(x=anio, y=total_vict))+
geom_line()
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
mutate(total_vict = sum(total)) %>%
ggplot(aes(x=anio, y=total_vict))+
geom_line()
df %>% group_by(anio)%>%
summarise(n=n())%>%
mutate(total=sum(n),
perc = (n/total)*100)%>%
ggplot(aes(x=anio, y=perc))+
geom_col()
vict_prov_anio <- df %>% group_by(Id_hecho, anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
head(vict_prov_anio)
knitr::opts_chunk$set(echo=FALSE)
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE, highlight=TRUE, paged.print=FALSE, prompt=TRUE, strip.white=FALSE)
library(tidyverse)
df <- readxl::read_xlsx("data/Integrado_HD_base_usuaria_2017-2020.xlsx")
ggplot()
tb1 <- df %>% group_by(anio)%>%
summarise(n=n_distinct(Id_hecho))
ggplot(tb1, aes(x=anio, y = n))+
geom_histogram(stat = 'identity')
df %>% group_by(anio, Id_hecho)%>%
summarise(total=sum(cant_vic))%>%
mutate(total_vict = sum(total)) %>%
ggplot(aes(x=anio, y=total_vict))+
geom_line()
df %>% group_by(anio)%>%
summarise(n=n())%>%
mutate(total=sum(n),
perc = (n/total)*100)%>%
ggplot(aes(x=anio, y=perc))+
geom_col()
df %>% group_by(anio, clase_arma)%>%
summarise(n=n())%>%
ggplot(aes(x=anio, y=n, color=clase_arma))+
geom_line()
ggplot(df, aes(x=anio, fill = provincia))+
geom_bar(position = "fill")
df %>% group_by(provincia)%>%
summarise(n=n_distinct(Id_hecho))
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))+
geom_bar(position = "fill")
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho))
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))+
geom_col(position = "fill")
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))+
geom_col(position = "fill")
library(viridis)
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))+
scale_fill_viridis_d(option="magma")
ggplot(df, aes(x=anio, fill = provincia))+
geom_bar(position = "fill")+
scale_fill_viridis_d(option="magma")
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))+
geom_bar(position = "fill")+
scale_fill_viridis_d(option="magma")
library(viridis)
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))+
geom_bar(position = "fill")
df %>% group_by(anio, provincia)%>%
summarise(n=n_distinct(Id_hecho)) %>%
ggplot(aes(x=anio, y = n, fill = provincia))+
geom_col(position = "fill")+
scale_fill_viridis_d(option="magma")
colores <- c("Femenino" = 'forestgreen', "Masculino" = 'darkorchid2')
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)
colores <- c("Femenino" = 'forestgreen', "Masculino" = 'darkorchid2')
df %>% filter(sexo_inculpado %in% c("Femenino", "Masculino"))%>%
ggplot(aes(x=anio, fill = sexo_inculpado))+
geom_bar(position = "dodge")+
scale_fill_manual(values = colores)
vict_prov_anio <- df %>% group_by(Id_hecho, anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))%>%
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
head(vict_prov_anio)
vict_prov_anio <- df %>% group_by(Id_hecho, anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))
df %>% group_by(Id_hecho, anio, provincia) %>%
summarise(n=n(),
tot_vic = sum(cant_vic))
df %>% group_by(anio, provincia) %>%
summarise(n = n_distinct(Id_hecho), #Cuento la cantidad de Id_hechos
tot_vic = sum(cant_vic))%>% #Cuento la cantidad de víctimas
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
vict_prov_anio <- df %>% group_by(anio, provincia) %>%
summarise(n = n_distinct(Id_hecho), #Cuento la cantidad de Id_hechos
tot_vic = sum(cant_vic))%>% #Cuento la cantidad de víctimas
ungroup()%>%
mutate(tasa_vic = tot_vic/n)
head(vict_prov_anio)
ggplot(vict_prov_anio, aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_color_viridis_d(option = "inferno")
ggplot(vict_prov_anio, aes(x = anio, y = n, color = provincia, size = tasa_vic))+
geom_point()+
scale_y_log10()+
scale_color_viridis_d(option = "inferno")
vict_prov_anio %>%
arrange(desc(tasa_vic))
View(df)
library(tidyverse)
library(ggplot2)
library(sf)
pba_geo <- read_sf("./data/deptos_pba.geojson")
head(pba_geo)
ggplot(pba_geo)+
geom_sf()
df <- readxl::read_xlsx("data/Integrado_HD_base_usuaria_2017-2020.xlsx")
#Formato
pba <- df %>% filter(provincia == "BUENOS AIRES")
pba <- pba %>% filter(departamento != "Departamento sin determinar")
pba <- pba %>% filter(anio ==2020)
#Join
pba_geo <- pba_geo %>% left_join(pba, by=c("in1"="Cod_INDEC"))
tb1 <- pba_geo%>%
group_by(anio, nam)%>%
summarise(n=n_distinct(Id_hecho, na.rm = TRUE))
ggplot(tb1, aes(fill=n))+
geom_sf()
ggplot(tb1)+
geom_sf(aes(fill = n), color = NA)
proyecciones <- readxl::read_excel("data/proy_pba.xls")
proyecciones <- proyecciones %>% mutate(Proyecciones_2020 = as.numeric(Proyecciones_2020))
pba_geo <- pba_geo %>%
left_join(proyecciones, by = c("nam" = "Partido"))
head(pba_geo)
tb2 <- pba_geo%>%
group_by(anio, nam, Proyecciones_2020)%>%
summarise(n=n_distinct(Id_hecho, na.rm = TRUE))
ggplot(tb2)+
geom_sf(aes(fill = n/Proyecciones_2020), color = NA)
library(viridis)
ggplot(tb2)+
geom_sf(aes(fill = Proyecciones_2020), color = NA)+
scale_fill_viridis_c()+
labs(title = "Provincia de Buenos Aires",
subtitle = "Homicidios dolosos en 2020",
fill = "HD/1000 habitantes")+
theme_minimal()
ggplot(tb2)+
geom_sf(aes(fill = Proyecciones_2020), color = NA)
tb2
ggplot(tb2)+
geom_sf(aes(fill = n/Proyecciones_2020), color = NA)
ggplot(tb2)+
geom_sf(aes(fill = n/Proyecciones_2020), color = NA)+
scale_fill_viridis_c()+
labs(title = "Provincia de Buenos Aires",
subtitle = "Homicidios dolosos en 2020",
fill = "HD/1000 habitantes")+
theme_minimal()
ggplot(tb2)+
geom_sf(aes(fill = n/Proyecciones_2020), color = NA)+
scale_fill_viridis_c()+
labs(title = "Provincia de Buenos Aires",
subtitle = "Homicidios dolosos en 2020",
fill = "HD/Cant. habitantes")+
theme_minimal()
library(viridis)
ggplot(tb2)+
geom_sf(aes(fill = n/Proyecciones_2020), color = NA)+
scale_fill_viridis_c()+
labs(title = "Provincia de Buenos Aires",
subtitle = "Homicidios dolosos en 2020",
fill = "HD/Cant. habitantes")+
theme_minimal()
library(leaflet)
pal <- colorNumeric("viridis", NULL)
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/hab1000),
label = ~paste0(nam, ": ", round(n/hab1000,2)))
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/Proyecciones_2020),
label = ~paste0(nam, ": ", round(n/hab1000,2)))
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/Proyecciones_2020),
label = ~paste0(nam, ": ", round(n/Proyecciones_2020,2)))
library(leaflet)
pal <- colorNumeric("viridis", NULL)
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/Proyecciones_2020),
label = ~paste0(nam, ": ", round(n/Proyecciones_2020,2)))
library(leaflet)
pal <- colorNumeric("viridis", NULL)
leaflet(tb2) %>%
addTiles() %>%
addPolygons(stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.8,
fillColor = ~pal(n/Proyecciones_2020),
label = ~paste0(nam, ": ", n/Proyecciones_2020))
Base_PUFEAF <- read.csv("~/Escritorio/Cursos/min_seguridad_curso/clase5/data/Base_PUFEAF.csv")
View(Base_PUFEAF)
table(base_PUFEAF$Situacion_De_Servicio)
table(Base_PUFEAF$Situacion_De_Servicio)
table(Base_PUFEAF$Situacion_de_Servicio)
